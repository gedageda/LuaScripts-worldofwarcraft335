local EnchantData = {
    -- 头部附魔
    ENCHANT_HEAD = {
        {spellId = -1, text = "清除头盔附魔", slot = 0},
        {spellId = 3832, text = "增加全属性", slot = 0},
        {spellId = 3820, text = "法术强度，爆击等级[80]", slot = 0},
        {spellId = 3819, text = "法术强度，法力回复[80]", slot = 0},
        {spellId = 3818, text = "增加耐力，防御等级[80]", slot = 0},
        {spellId = 3817, text = "攻击强度，爆击等级[80]", slot = 0},
        {spellId = 3842, text = "增加耐力，韧性等级[80]", slot = 0},
        {spellId = 3795, text = "攻击强度，韧性等级[80]", slot = 0},
        {spellId = 3797, text = "法术强度，韧性等级[80]", slot = 0},
    },
    
    -- 肩部附魔
    ENCHANT_SHOULDERS = {
        {spellId = -1, text = "清除肩甲附魔", slot = 2},
        {spellId = 3832, text = "增加全属性", slot = 2},
        {spellId = 3793, text = "攻击强度，韧性等级[80]", slot = 2},
        {spellId = 3845, text = "攻击强度", slot = 2},
        {spellId = 3794, text = "法术强度，韧性等级[80]", slot = 2},
        {spellId = 3852, text = "增加耐力，韧性等级[80]", slot = 2},
        {spellId = 3808, text = "攻击强度，爆击等级[80]", slot = 2},
        {spellId = 3809, text = "法术强度，法力回复[80]", slot = 2},
        {spellId = 3811, text = "闪避等级，防御等级[80]", slot = 2},
        {spellId = 3810, text = "法术强度，爆击等级[80]", slot = 2},
    },
    
    -- 胸甲附魔
    ENCHANT_CHEST = {
        {spellId = -1, text = "清除胸甲附魔", slot = 4},
        {spellId = 3832, text = "增加全属性", slot = 4},
        {spellId = 3297, text = "增加生命", slot = 4},
        {spellId = 2381, text = "法力回复", slot = 4},
        {spellId = 3245, text = "韧性等级", slot = 4},
        {spellId = 1953, text = "防御等级", slot = 4},
    },
    
    -- 衬衣附魔
    ENCHANT_SHIRT = {
        {spellId = -1, text = "清除胸甲附魔", slot = 3},
        {spellId = 3832, text = "增加全属性", slot = 3},
        {spellId = 3297, text = "增加生命", slot = 3},
        {spellId = 2381, text = "法力回复", slot = 3},
        {spellId = 3245, text = "韧性等级", slot = 3},
        {spellId = 1953, text = "防御等级", slot = 3},
        {spellId = 1099, text = "增加敏捷", slot = 3},
        {spellId = 3845, text = "攻击强度", slot = 3},
    },
    
    -- 腿部附魔
    ENCHANT_LEGS = {
        {spellId = -1, text = "清除裤子附魔", slot = 6},
        {spellId = 3719, text = "增加精神，法术强度[70]", slot = 6},
        {spellId = 3721, text = "增加耐力，法术强度[70]", slot = 6},
        {spellId = 3853, text = "增加耐力，韧性等级[80]", slot = 6},
        {spellId = 3822, text = "增加耐力，敏捷[80]", slot = 6},
        {spellId = 3823, text = "攻击强度，爆击等级[80]", slot = 6},
        {spellId = 2332, text = "法术强度", slot = 6},
        {spellId = 3845, text = "攻击强度", slot = 6},
        {spellId = 3832, text = "增加全属性", slot = 6},
    },
    
    -- 主手武器附魔
    ENCHANT_MAINHAND = {
        {spellId = -1, text = "清除主手武器附魔", slot = 15},
        {spellId = 3851, text = "增加耐力", slot = 15},
        {spellId = 3788, text = "命中等级，爆击等级", slot = 15},
        {spellId = 3789, text = "狂暴", slot = 15},
        {spellId = 3790, text = "黑魔法", slot = 15},
        {spellId = 3239, text = "破冰武器", slot = 15},
        {spellId = 3241, text = "生命护卫", slot = 15},
        {spellId = 3870, text = "吸血[75]", slot = 15},
        {spellId = 3869, text = "利刃防护[75]", slot = 15},
        {spellId = 1103, text = "增加敏捷", slot = 15},
        {spellId = 3844, text = "增加精神", slot = 15},
        {spellId = 3225, text = "斩杀", slot = 15},
        {spellId = 2673, text = "猫鼬", slot = 15},
        {spellId = 3827, text = "攻击强度", slot = 15},
        {spellId = 3854, text = "法术强度", slot = 15},
    },
    
    -- 副手武器附魔
    ENCHANT_OFFHAND = {
        {spellId = -1, text = "清除副手武器附魔", slot = 16},
        {spellId = 3851, text = "增加耐力", slot = 16},
        {spellId = 3788, text = "命中等级，爆击等级", slot = 16},
        {spellId = 3789, text = "狂暴", slot = 16},
        {spellId = 3790, text = "黑魔法", slot = 16},
        {spellId = 3239, text = "破冰武器", slot = 16},
        {spellId = 3241, text = "生命护卫", slot = 16},
        {spellId = 3870, text = "吸血[75]", slot = 16},
        {spellId = 3869, text = "利刃防护[75]", slot = 16},
        {spellId = 1103, text = "增加敏捷", slot = 16},
        {spellId = 3844, text = "增加精神", slot = 16},
        {spellId = 3225, text = "斩杀", slot = 16},
        {spellId = 2673, text = "猫鼬", slot = 16},
        {spellId = 3827, text = "攻击强度", slot = 16},
        {spellId = 3854, text = "法术强度", slot = 16},
    }
}

-- 通过装备槽位获取附魔列表
function EnchantData:GetEnchantsBySlot(slotId)
    for _, enchantList in pairs(self) do
        if enchantList[1] and enchantList[1].slot == slotId then
            return enchantList
        end
    end
    return nil
end

-- 通过菜单ID获取附魔列表
function EnchantData:GetEnchantsByMenu(menuId)
    return self[menuId]
end

-- 获取所有附魔ID
function EnchantData:GetAllEnchantIds()
    local ids = {}
    for _, enchantList in pairs(self) do
        for _, enchant in ipairs(enchantList) do
            if enchant.spellId > 0 then
                table.insert(ids, enchant.spellId)
            end
        end
    end
    return ids
end

-- 验证附魔数据
function EnchantData:Validate()
    local errors = {}
    
    for menuId, enchants in pairs(self) do
        if type(enchants) ~= "table" then
            table.insert(errors, "附魔菜单 " .. menuId .. " 不是有效的表格")
        else
            for i, enchant in ipairs(enchants) do
                if not enchant.spellId or not enchant.text or enchant.slot == nil then
                    table.insert(errors, string.format("附魔菜单 %s 第 %d 项缺少必需字段", menuId, i))
                end
            end
        end
    end
    
    return #errors == 0, errors
end

return EnchantData
